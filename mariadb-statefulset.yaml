
                memory: 384Mi
              requests:
                cpu: 250m
                ephemeral-storage: 50Mi
                memory: 256Mi
            securityContext:
              allowPrivilegeEscalation: false
              capabilities:
                drop:
                - ALL
              privileged: false
              readOnlyRootFilesystem: true
              runAsGroup: 1001
              runAsNonRoot: true
              runAsUser: 1001
              seLinuxOptions: {}
              seccompProfile:
                type: RuntimeDefault
            command:
              - /bin/bash
            args:
              - -ec
              - |
                #!/bin/bash
  
                . /opt/bitnami/scripts/liblog.sh
                . /opt/bitnami/scripts/libfs.sh
  
                info "Copying base dir to empty dir"
                # In order to not break the application functionality (such as upgrades or plugins) we need
                # to make the base directory writable, so we need to copy it to an empty dir volume
                cp -r --preserve=mode /opt/bitnami/wordpress /emptydir/app-base-dir
  
                info "Copying symlinks to stdout/stderr"
                # We copy the logs folder because it has symlinks to stdout and stderr
                if ! is_dir_empty /opt/bitnami/apache/logs; then
                  cp -r /opt/bitnami/apache/logs /emptydir/apache-logs-dir
                fi
  
                info "Copying default PHP config"
                cp -r --preserve=mode /opt/bitnami/php/etc /emptydir/php-conf-dir
  
                info "Copying php var directory"
                if ! is_dir_empty /opt/bitnami/php/var; then
                  cp -r /opt/bitnami/php/var /emptydir/php-var-dir
                fi
  
                info "Copy operation completed"
            env:
              - name: OPENSSL_FIPS
                value: "yes"
            volumeMounts:
              - name: empty-dir
                mountPath: /emptydir
        containers:
          - name: wordpress
            image: registry-1.docker.io/bitnami/wordpress:latest
            imagePullPolicy: "IfNotPresent"
            securityContext:
              allowPrivilegeEscalation: false
              capabilities:
                drop:
                - ALL
              privileged: false
              readOnlyRootFilesystem: true
              runAsGroup: 1001
              runAsNonRoot: true
              runAsUser: 1001
              seLinuxOptions: {}
              seccompProfile:
                type: RuntimeDefault
            env:
              - name: BITNAMI_DEBUG
                value: "false"
              - name: ALLOW_EMPTY_PASSWORD
                value: "yes"
              - name: WORDPRESS_SKIP_BOOTSTRAP
                value: "no"
              - name: MARIADB_HOST
                value: "wordpress-mariadb"
              - name: MARIADB_PORT_NUMBER
                value: "3306"
              - name: WORDPRESS_DATABASE_NAME
                value: "bitnami_wordpress"
              - name: WORDPRESS_DATABASE_USER
                value: "bn_wordpress"
              - name: WORDPRESS_DATABASE_PASSWORD_FILE
                value: "/secrets/mariadb-password"
              - name: WORDPRESS_USERNAME
                value: "user"
              - name: WORDPRESS_PASSWORD_FILE
                value: "/secrets/wordpress-password"
              - name: WORDPRESS_EMAIL
                value: "user@example.com"
              - name: WORDPRESS_FIRST_NAME
                value: "FirstName"
              - name: WORDPRESS_LAST_NAME
                value: "LastName"
              - name: WORDPRESS_HTACCESS_OVERRIDE_NONE
                value: "no"
              - name: WORDPRESS_ENABLE_HTACCESS_PERSISTENCE
                value: "no"
              - name: WORDPRESS_BLOG_NAME
                value: "User's Blog!"
              - name: WORDPRESS_TABLE_PREFIX
                value: "wp_"
              - name: WORDPRESS_SCHEME
                value: "http"
              - name: WORDPRESS_EXTRA_WP_CONFIG_CONTENT
                value: ""
              - name: WORDPRESS_PLUGINS
                value: "none"
              - name: WORDPRESS_OVERRIDE_DATABASE_SETTINGS
                value: "no"
              - name: APACHE_HTTP_PORT_NUMBER
                value: "8080"
              - name: APACHE_HTTPS_PORT_NUMBER
                value: "8443"
              - name: OPENSSL_FIPS
                value: "yes"
            envFrom:
            ports:
              - name: http
                containerPort: 8080
              - name: https
                containerPort: 8443
            livenessProbe:
              failureThreshold: 6
              initialDelaySeconds: 120
              periodSeconds: 10
              successThreshold: 1
              tcpSocket:
                port: http
              timeoutSeconds: 5
            readinessProbe:
              failureThreshold: 6
              httpGet:
                httpHeaders: []
                path: /wp-login.php
                port: 'http'
                scheme: 'HTTP'
              initialDelaySeconds: 30
              periodSeconds: 10
              successThreshold: 1
              timeoutSeconds: 5
            resources:
              limits:
                cpu: 375m
                ephemeral-storage: 2Gi
                memory: 384Mi
              requests:
                cpu: 250m
                ephemeral-storage: 50Mi
                memory: 256Mi
            volumeMounts:
              - name: empty-dir
                mountPath: /opt/bitnami/apache/conf
                subPath: apache-conf-dir
              - name: empty-dir
                mountPath: /opt/bitnami/apache/logs
                subPath: apache-logs-dir
              - name: empty-dir
                mountPath: /opt/bitnami/apache/var/run
                subPath: apache-tmp-dir
              - name: empty-dir
                mountPath: /opt/bitnami/php/etc
                subPath: php-conf-dir
              - name: empty-dir
                mountPath: /opt/bitnami/php/tmp
                subPath: php-tmp-dir
              - name: empty-dir
                mountPath: /opt/bitnami/php/var
                subPath: php-var-dir
              - name: empty-dir
                mountPath: /tmp
                subPath: tmp-dir
              - name: empty-dir
                mountPath: /opt/bitnami/wordpress
                subPath: app-base-dir
              - mountPath: /bitnami/wordpress
                name: wordpress-data
                subPath: wordpress
              - name: wordpress-secrets
                mountPath: /secrets
        volumes:
          - name: empty-dir
            emptyDir: {}
          - name: wordpress-secrets
            projected:
              sources:
                - secret:
                    name:  wordpress
                - secret:
                    name:  wordpress-mariadb
          - name: wordpress-data
            persistentVolumeClaim:
              claimName: wordpress
  ---
  # Source: wordpress/charts/mariadb/templates/primary/statefulset.yaml
  apiVersion: apps/v1
> kind: StatefulSet
  metadata:
    name: wordpress-mariadb
    namespace: "wordpress"
    labels:
      app.kubernetes.io/instance: wordpress
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: mariadb
      app.kubernetes.io/version: 12.0.2
      helm.sh/chart: mariadb-22.0.2
      app.kubernetes.io/part-of: mariadb
      app.kubernetes.io/component: primary
  spec:
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/instance: wordpress
        app.kubernetes.io/name: mariadb
        app.kubernetes.io/part-of: mariadb
        app.kubernetes.io/component: primary
    serviceName: wordpress-mariadb-headless
    updateStrategy:
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/configuration: 2585b3e38a977548650b5d5aee8d0648599f58e76e2e80b341a70b9ef3d7998c
        labels:
          app.kubernetes.io/instance: wordpress
          app.kubernetes.io/managed-by: Helm
          app.kubernetes.io/name: mariadb
          app.kubernetes.io/version: 12.0.2
          helm.sh/chart: mariadb-22.0.2
          app.kubernetes.io/part-of: mariadb
          app.kubernetes.io/component: primary
      spec:
        
        automountServiceAccountToken: false
        serviceAccountName: wordpress-mariadb
        affinity:
          podAffinity:
            
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
              - podAffinityTerm:
                  labelSelector:
                    matchLabels:
                      app.kubernetes.io/instance: wordpress
                      app.kubernetes.io/name: mariadb
                      app.kubernetes.io/component: primary
                  topologyKey: kubernetes.io/hostname
                weight: 1
          nodeAffinity:
            
        securityContext:
          fsGroup: 1001
          fsGroupChangePolicy: Always
          supplementalGroups: []
          sysctls: []
        initContainers:
          - name: preserve-logs-symlinks
            image: registry-1.docker.io/bitnami/mariadb:latest
            imagePullPolicy: "IfNotPresent"
            securityContext:
              allowPrivilegeEscalation: false
              capabilities:
                drop:
                - ALL
              privileged: false
              readOnlyRootFilesystem: true
              runAsGroup: 1001
              runAsNonRoot: true
              runAsUser: 1001
              seLinuxOptions: {}
              seccompProfile:
                type: RuntimeDefault
            resources: 
              limits:
                cpu: 200m
                memory: 256Mi
              requests:
                cpu: 25m
                memory: 128Mi
            command:
              - /bin/bash
            args:
              - -ec
              - |
                #!/bin/bash
  
                . /opt/bitnami/scripts/libfs.sh
                # We copy the logs folder because it has symlinks to stdout and stderr
                if ! is_dir_empty /opt/bitnami/mariadb/logs; then
                  cp -r /opt/bitnami/mariadb/logs /emptydir/app-logs-dir
                fi
            volumeMounts:
              - name: empty-dir
                mountPath: /emptydir
        containers:
          - name: mariadb
            image: registry-1.docker.io/bitnami/mariadb:latest
            imagePullPolicy: "IfNotPresent"
            securityContext:
              allowPrivilegeEscalation: false
              capabilities:
                drop:
                - ALL
              privileged: false
              readOnlyRootFilesystem: true
              runAsGroup: 1001
              runAsNonRoot: true
              runAsUser: 1001
              seLinuxOptions: {}
              seccompProfile:
                type: RuntimeDefault
            env:
              - name: BITNAMI_DEBUG
                value: "false"
              - name: MARIADB_ROOT_PASSWORD_FILE
                value: /opt/bitnami/mariadb/secrets/mariadb-root-password
              - name: MARIADB_USER
                value: "bn_wordpress"
              - name: MARIADB_PASSWORD_FILE
                value: /opt/bitnami/mariadb/secrets/mariadb-password
              - name: MARIADB_DATABASE
                value: "bitnami_wordpress"
              - name: MARIADB_ENABLE_SSL
                value: "no"
            ports:
              - name: mysql
                containerPort: 3306
            livenessProbe:
              failureThreshold: 3
              initialDelaySeconds: 120
              periodSeconds: 10
              successThreshold: 1
              timeoutSeconds: 1
              exec:
                command:
                  - /bin/bash
                  - -ec
                  - |
                    password_aux="${MARIADB_ROOT_PASSWORD:-}"
                    if [[ -f "${MARIADB_ROOT_PASSWORD_FILE:-}" ]]; then
                        password_aux=$(cat "$MARIADB_ROOT_PASSWORD_FILE")
                    fi
                    mariadb-admin status -uroot -p"${password_aux}"
            readinessProbe:
              failureThreshold: 3
              initialDelaySeconds: 30
              periodSeconds: 10
              successThreshold: 1
              timeoutSeconds: 1
              exec:
                command:
                  - /bin/bash
                  - -ec
                  - |
                    password_aux="${MARIADB_ROOT_PASSWORD:-}"
                    if [[ -f "${MARIADB_ROOT_PASSWORD_FILE:-}" ]]; then
                        password_aux=$(cat "$MARIADB_ROOT_PASSWORD_FILE")
                    fi
                    mariadb-admin ping -uroot -p"${password_aux}"
            resources: 
              limits:
                cpu: 200m
                memory: 256Mi
              requests:
                cpu: 25m
                memory: 128Mi
            volumeMounts:
              - name: data
                mountPath: /bitnami/mariadb
              - name: config
                mountPath: /opt/bitnami/mariadb/conf/my.cnf
                subPath: my.cnf
              - name: mariadb-credentials
                mountPath: /opt/bitnami/mariadb/secrets/
              - name: empty-dir
                mountPath: /tmp
                subPath: tmp-dir
              - name: empty-dir
                mountPath: /opt/bitnami/mariadb/conf
                subPath: app-conf-dir
              - name: empty-dir
                mountPath: /opt/bitnami/mariadb/tmp
                subPath: app-tmp-dir
              - name: empty-dir
                mountPath: /opt/bitnami/mariadb/logs
                subPath: app-logs-dir
        volumes:
          - name: empty-dir
            emptyDir: {}
          - name: config
            configMap:
              name: wordpress-mariadb
          - name: mariadb-credentials
            secret:
              secretName: wordpress-mariadb
              items:


